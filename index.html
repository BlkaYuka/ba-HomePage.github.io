<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MILLENNIUM24 INSUBUNHAE STORE</title>
  <meta name="description" content="히어로 고정 + 스크롤 페이드 + 긴 이미지 풀스크롤 리빌" />
  <link rel="icon" href="./assets/favicon.png?v=20250920" />
  <link rel="preload" as="image" href="./assets/main-hero.png?v=20250920" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css">
  <style>
    :root{
      --ease: cubic-bezier(.22,.61,.36,1);
      --p: 0;           /* 스크롤 진행도(0~1) */
      --hero-o: 1.0;    /* 히어로 투명도 (JS가 세팅) */
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;overscroll-behavior-x:none;touch-action:pan-y}
    body{
      color:#0f172a;
      background:#0f2446 url('./assets/background.png?v=20250920') center/cover fixed no-repeat;
      overflow-x:hidden;
      font-family: "Pretendard Variable", Pretendard, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    /* ===== Scroll Scene ===== */
    .scene{ position:relative; height:200vh; }
    .sticky{ position:sticky; top:0; height:100vh; overflow:hidden; }
    .sticky::after{
      content:""; position:absolute; inset:0; pointer-events:none; z-index:0;
      background: rgba(3,7,18, calc(var(--p) * 0.35));
    }

    /* ===== Hero ===== */
    .hero{
      position:relative; height:100%;
      display:flex; justify-content:center; align-items:center;
      z-index:3;
      isolation:isolate;
    }
    .hero-shell{position:relative; width:min(1180px,92vw); margin:0 auto}
    .hero-inner{display:flex; flex-direction:column; align-items:center; gap:1.2rem; position:relative;}

    .hero-banner{display:block; width:min(400px,64vw); max-width:100%;
      border-radius:1rem; mix-blend-mode:screen; filter:drop-shadow(0 18px 48px rgba(8,30,60,.38));
      opacity:0}
    .hero-banner-top{margin-bottom:.6rem}
    .hero-banner-bottom{margin-top:.6rem}
    .hero-bottom{position:relative; display:inline-flex; align-items:flex-end; justify-content:center; width:100%;}
    .hero-location-shell{position:absolute; left:0; top:50%; transform:translate(-48%, -52%); pointer-events:none;}
    .hero-play-shell{position:absolute; right:0; top:50%; transform:translate(48%, -52%); pointer-events:none;}
    .hero-location{display:block; width:min(220px,32vw); max-width:210px; pointer-events:auto; cursor:pointer;
      opacity:0; filter:drop-shadow(0 12px 30px rgba(8,30,60,.32)); transition:filter .2s var(--ease);
      transform-origin:52% 48%;
    }
    .hero-location:hover{filter:drop-shadow(0 16px 36px rgba(8,30,60,.42));}
    .hero-play{display:block; width:min(220px,32vw); max-width:230px; pointer-events:auto; cursor:pointer;
      opacity:0; filter:drop-shadow(0 12px 30px rgba(8,30,60,.32)); transition:filter .2s var(--ease);
      transform-origin:48% 46%;
    }
    .hero-play:hover{filter:drop-shadow(0 16px 36px rgba(8,30,60,.42));}
    .hero-img{display:block; width:100%; max-width:min(660px,82vw); max-height:66vh; object-fit:contain;
      filter:drop-shadow(0 24px 60px rgba(15,23,42,.35)); opacity:0}

    /* 로딩 시 1회 등장 애니 */
    .ready .hero-banner.hero-banner-top{animation:slideDown .9s var(--ease) forwards}
    .ready .hero-img{animation:pop .95s var(--ease) .12s forwards}
    .ready .hero-banner.hero-banner-bottom{animation:slideUp .9s var(--ease) .22s forwards}
    .ready .hero-location{animation:cloudIn .95s var(--ease) .32s forwards; opacity:1;}
    .ready .hero-play{animation:cloudIn .95s var(--ease) .36s forwards; opacity:1;}
    @keyframes pop{0%{opacity:0;transform:translateY(8px) scale(.92)}60%{opacity:1;transform:translateY(0) scale(1.06)}100%{opacity:1;transform:translateY(0) scale(1)}}
    @keyframes slideDown{from{opacity:0;transform:translateY(-14px)}to{opacity:1;transform:translateY(0)}}
    @keyframes slideUp{from{opacity:0;transform:translateY(14px)}to{opacity:1;transform:translateY(0)}}
    @keyframes cloudIn{
      0%{opacity:0;transform:translate(-26px,-14px) scale(.92)}
      60%{opacity:1;transform:translate(8px,6px) scale(1.06)}
      100%{opacity:1;transform:translate(0,0) scale(1)}
    }
    @keyframes cloudShake{
      0%,100%{transform:translate(0,0) rotate(0)}
      20%{transform:translate(8px,-2px) rotate(2deg)}
      40%{transform:translate(-10px,2px) rotate(-2deg)}
      60%{transform:translate(6px,-1px) rotate(1.5deg)}
      80%{transform:translate(-7px,1px) rotate(-1.5deg)}
    }
    .hero-location.is-shaking{animation:cloudShake .6s ease; opacity:1;}

    /* 스크롤 중 히어로 페이드 */
    .hero-fade{ transition: opacity .12s var(--ease); opacity: var(--hero-o, 1) !important; }

    /* ===== info 이미지 (아래 레이어) ===== */
    .info-rail{
      position:absolute; top:0; left:50%; transform:translateX(-50%);
      height:100vh; z-index:1; pointer-events:none; will-change:transform;
    }
    .info-img{
      display:block; width:min(1100px,95vw); height:auto;
      border-radius:16px; box-shadow:0 10px 30px rgba(0,0,0,.08);
      opacity: calc(0.3 + var(--p)*3.8);
      transform: translateY(var(--info-y, 0px));
      will-change: transform, opacity;
    }

    /* Popup (공통) */
    .popup{position:fixed; inset:0; z-index:20; display:flex; align-items:center; justify-content:center;}
    .popup[hidden]{display:none}
    .popup-backdrop{position:absolute; inset:0; background:rgba(2,6,23,.65); backdrop-filter:blur(6px);}
    .popup-card{position:relative; z-index:1; max-width:min(720px,92vw); background:rgba(15,23,42,.94);
      border-radius:18px; box-shadow:0 22px 60px rgba(2,6,23,.45); padding:32px 32px 28px;}
    .popup-img{display:block; width:100%; height:auto; border-radius:12px; box-shadow:0 10px 26px rgba(0,0,0,.28);}
    .popup-close{position:absolute; top:10px; right:14px; border:0; background:transparent; color:#e2e8f0;
      font-size:32px; line-height:1; cursor:pointer; padding:4px;}
    .popup-close:hover{color:#f8fafc}

    @media (prefers-reduced-motion:reduce){
      .hero-banner,.hero-img{opacity:1;animation:none !important;transform:none}
      .hero-location{opacity:1;animation:none !important;transform:none;}
      .hero-location.is-shaking{animation:none}
      .hero-fade{opacity:1;transition:none}
      .info-img{opacity:1;transform:none}
      .sticky::after{background:rgba(3,7,18,.12)}
    }

    @media (max-width:900px){
      .hero-inner{gap:1.2rem}
      .hero-img{max-width:74vw;max-height:60vh}
      .hero-banner{width:min(360px,82vw)}
      .hero-location{max-width:160px}
      .popup-card{padding:24px 24px 20px}
      .popup-close{top:6px, right:10px}
    }

    /* ===== Mobile layout (≤900px) ===== */
    @media (max-width: 900px){
      .hero-bottom{
        display:grid;
        grid-template-columns: 1fr 1fr;
        grid-template-areas:
          "banner banner"
          "left   right";
        align-items:end;
        justify-items:center;
        row-gap:.6rem;
        column-gap:.75rem;
        width:100%;
        padding: .25rem 16px calc(14px + env(safe-area-inset-bottom, 0px));
      }
      .hero-banner.hero-banner-bottom{ grid-area: banner; margin: .35rem 0 .15rem 0; }
      .hero-location-shell,
      .hero-play-shell{ position: static; transform: none; pointer-events: none; width: 100%; display: flex; justify-content: center; }
      .hero-location-shell{ grid-area: left; }
      .hero-play-shell{ grid-area: right; }
      .hero-location, .hero-play{ pointer-events:auto; width: clamp(140px, 42vw, 200px); height:auto; max-width:200px; }
      .hero-img{ max-width:78vw; max-height:56vh; }
      .hero-banner{ width:min(320px,78vw); }

      /* 데스크톱용 기여자 스택 숨김 강제 */
      .contributors{ display:none !important; }
    }
    @media (max-width: 900px){
      body{
          background-image: url('./assets/background_mobile.png?v=20250920');
          background-attachment: scroll;
          background-position: center top;
          background-size: cover;
      }
    }

    /* ===== Scroll indicator ===== */
    .scroll-indicator{
      position:absolute;
      bottom:14px; left:50%; transform:translateX(-50%);
      display:flex; flex-direction:column; align-items:center;
      font-size:12px; font-weight:700; letter-spacing:.08em;
      color:#e2e8f0; opacity: calc(var(--hero-o,1) * .9);
      animation:bounce 1.8s infinite;
      pointer-events:none; z-index:1000;
      text-shadow:0 2px 10px rgba(0,0,0,.35);
      will-change: transform, opacity;
    }
    .scroll-indicator svg{ width:18px; height:18px; margin-bottom:4px; fill:currentColor; }
    @keyframes bounce{ 0%,100%{transform:translate3d(-50%,0,0)} 50%{transform:translate3d(-50%,6px,0)} }
    .scroll-indicator.hide{ opacity:0; transition:opacity .4s ease; }
    @supports (-webkit-touch-callout: none) {
      .scroll-indicator.is-safari-fixed{
        position: fixed;
        bottom: 14px;
        left: 50%;
        transform: translateX(-50%);
      }
    }

    /* ===== Contributors (desktop left fixed stack) ===== */
    .contributors{
      position: fixed;
      left: 12px;
      top: 14px;
      z-index: 60;
      display: flex;
      flex-direction: column;
      gap: 10px;
      pointer-events: none;
    }
    .contributors a{
      pointer-events: auto;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      min-height: 44px;
      border-radius: 12px;
      text-decoration: none;
      font-weight: 800;
      letter-spacing: .01em;
      color: #e2e8f0;
      background: rgba(15,23,42,.72);
      border: 1px solid rgba(148,163,184,.22);
      box-shadow: 0 8px 24px rgba(2,6,23,.28);
      transition: transform .15s var(--ease), box-shadow .15s var(--ease), background .15s var(--ease);
    }
    .contributors a:hover,
    .contributors a:focus-visible{
      transform: translateY(-1px);
      box-shadow: 0 12px 28px rgba(2,6,23,.38);
      background: rgba(15,23,42,.82);
      outline: none;
    }
    .contributors a svg{
      width: 18px; height: 18px; flex:0 0 18px;
      filter: drop-shadow(0 2px 6px rgba(0,0,0,.25));
    }
    .contributors a span{
      max-width: 160px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* ===== Mobile FAB ("C" circle) — 고급 스타일 ===== */
    .contributors-fab{
      position: fixed;
      left: max(10px, env(safe-area-inset-left, 0px));
      top:  max(10px, env(safe-area-inset-top,  0px));
      z-index: 70;

      display: none;                 /* 데스크톱에서 숨김 */
      width: 48px; height: 48px;
      border-radius: 9999px;

      /* 글래스 + 그라데이션 */
      background:
        radial-gradient(120% 140% at 20% 15%, rgba(255,255,255,.28) 0%, rgba(255,255,255,0) 60%),
        linear-gradient(180deg, #cfe0ff 0%, #a9bbff 100%);
      color: #0f172a;
      font-weight: 900; font-size: 18px;
      letter-spacing: .02em;

      border: 1px solid rgba(148,163,184,.35);
      box-shadow:
        0 12px 28px rgba(2,6,23,.35),
        inset 0 1px 0 rgba(255,255,255,.35);
      backdrop-filter: blur(6px);

      align-items: center; justify-content: center;
      cursor: pointer;

      transition:
        transform .18s var(--ease),
        box-shadow .18s var(--ease),
        background .18s var(--ease),
        opacity .12s var(--ease);
    }
    .contributors-fab .c-letter{
      transform: translateY(0.5px);
      text-shadow:
        0 1px 0 rgba(255,255,255,.5),
        0 2px 6px rgba(2,6,23,.25);
      user-select: none;
    }
    .contributors-fab:hover,
    .contributors-fab:focus-visible{
      transform: translateY(-1px);
      box-shadow:
        0 16px 34px rgba(2,6,23,.45),
        inset 0 1px 0 rgba(255,255,255,.45);
      outline: none;
    }
    .contributors-fab:focus-visible{
      box-shadow:
        0 0 0 3px rgba(99,102,241,.45),
        0 12px 28px rgba(2,6,23,.35),
        inset 0 1px 0 rgba(255,255,255,.35);
    }
    .contributors-fab:active::after{
      content:"";
      position:absolute; inset:0; border-radius:inherit;
      background: radial-gradient(40% 40% at 50% 50%, rgba(255,255,255,.35), transparent 60%);
      animation: fab-ripple .35s ease;
    }
    @keyframes fab-ripple{
      from{ opacity:.7; transform:scale(.7); }
      to  { opacity:0;  transform:scale(1.3); }
    }
    @media (max-width: 900px){
      .contributors-fab{ display:flex; }
    }
    @media (prefers-reduced-motion: reduce){
      .contributors-fab,
      .contributors-fab:active::after{
        transition:none !important;
        animation:none !important;
      }
    }

    /* ===== Contributors Popup (mobile) ===== */
    .contributors-popup-card{
      max-width:min(520px, 94vw);
      padding: 20px 18px 16px;
    }
    .contributors-popup-title{
      margin: 0 30px 12px 0;
      color: #e2e8f0;
      font-size: 16px; font-weight: 800;
    }
    .contributors-list{
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
      margin-top: 8px;
    }
    .contributors-item{
      display:flex; align-items:center; gap:10px;
      padding:10px 12px; border-radius:12px;
      background: rgba(15,23,42,.72);
      border: 1px solid rgba(148,163,184,.22);
      text-decoration:none; color:#e2e8f0; font-weight:800;
    }
    .contributors-item img, .contributors-item svg{
      width:20px; height:20px; flex:0 0 20px;
    }

    /* ===== Unofficial badge (bottom-right) ===== */
    .unofficial-badge{
      position: fixed;
      right: max(8px, env(safe-area-inset-right, 0px));
      bottom: max(10px, env(safe-area-inset-bottom, 0px));
      z-index: 80;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 10px;
      border-radius: 10px;
      font-size: 12px;
      line-height: 1.2;
      font-weight: 700;
      letter-spacing: .01em;
      color: #e2e8f0;
      background: rgba(15,23,42,.72);
      border: 1px solid rgba(148,163,184,.24);
      box-shadow: 0 8px 24px rgba(2,6,23,.28);
      backdrop-filter: blur(6px);
      text-decoration: none;
      cursor: default;
    }
    .unofficial-badge small{ opacity: .85; font-weight: 600; }
    .unofficial-badge a{
      color: #c7d2fe; text-decoration: underline; text-underline-offset: 2px;
    }
    .unofficial-badge:hover{
      background: rgba(15,23,42,.82);
      transform: translateY(-1px);
      transition: all .15s var(--ease);
    }
    @media (max-width: 900px){
      .unofficial-badge{
        padding: 7px 9px; font-size: 11px;
        right: max(6px, env(safe-area-inset-right, 0px));
        bottom: max(8px, env(safe-area-inset-bottom, 0px));
      }
    }
  </style>
</head>
<body>

  <!-- ===== SVG ICON SPRITE (YouTube / X / GitHub / Link) ===== -->
  <svg width="0" height="0" style="position:absolute;visibility:hidden" aria-hidden="true">
    <symbol id="ic-youtube" viewBox="0 0 24 24"><path d="M23.5 6.2a4 4 0 0 0-2.8-2.8C18.7 3 12 3 12 3s-6.7 0-8.7.4A4 4 0 0 0 .5 6.2 41 41 0 0 0 0 12a41 41 0 0 0 .5 5.8 4 4 0 0 0 2.8 2.8C5.3 21 12 21 12 21s6.7 0 8.7-.4a4 4 0 0 0 2.8-2.8A41 41 0 0 0 24 12a41 41 0 0 0-.5-5.8zM9.7 15.5V8.5l6.4 3.5-6.4 3.5z"/></symbol>
    <symbol id="ic-x" viewBox="0 0 24 24"><path d="M18.3 2H21l-6.3 7.2L22 22h-6.8l-5.3-6.9L3.7 22H1l6.8-7.7L2 2h6.9l5 6.6L18.3 2zm-2 18h2.2L7.9 4H5.6l10.7 16z"/></symbol>
    <symbol id="ic-github" viewBox="0 0 24 24"><path d="M12 .5a12 12 0 0 0-3.8 23.4c.6.1.8-.3.8-.6V21c-3.3.7-4-1.6-4-1.6-.6-1.4-1.3-1.8-1.3-1.8-1-.7.1-.7.1-.7 1.1.1 1.6 1.1 1.6 1.1 1 .1.7 1.8 2.9 1.3.1-.8.4-1.3.8-1.6-2.6-.3-5.4-1.3-5.4-6a4.6 4.6 0 0 1 1.2-3.2 4.3 4.3 0 0 1 .1-3.2s1-.3 3.3 1.2a11.4 11.4 0 0 1 6 0C16.5 3.9 17.5 4.2 17.5 4.2a4.3 4.3 0 0 1 .1 3.2 4.6 4.6 0 0 1 1.2 3.2c0 4.7-2.8 5.7-5.4 6 .4.3.8 1 .8 2v3c0 .3.2.7.8.6A12 12 0 0 0 12 .5z"/></symbol>
    <symbol id="ic-link" viewBox="0 0 24 24">
      <path d="M10.6 13.4a5 5 0 0 0 7.1 0l2-2a5 5 0 1 0-7.1-7.1l-1.6 1.6a1 1 0 1 0 1.4 1.4l1.6-1.6a3 3 0 1 1 4.3 4.3l-2 2a3 3 0 0 1-4.3 0 1 1 0 0 0-1.4 1.4z"/>
      <path d="M13.4 10.6a5 5 0 0 0-7.1 0l-2 2a5 5 0 1 0 7.1 7.1l1.6-1.6a1 1 0 1 0-1.4-1.4l-1.6 1.6a3 3 0 1 1-4.3-4.3l2-2a3 3 0 0 1 4.3 0 1 1 0 0 0 1.4-1.4z"/>
    </symbol>
  </svg>

  <!-- ===== 좌측 고정(데스크톱): 기여자 링크 리스트 ===== -->
  <nav id="contributorsList" class="contributors hero-fade" aria-label="프로젝트 기여자"></nav>

  <!-- ===== 모바일: 기여자 FAB 버튼 ===== -->
  <button id="contributorsFab" class="contributors-fab hero-fade" aria-controls="contributorsPopup" aria-haspopup="dialog" aria-label="기여자 보기">
    <span class="c-letter">C</span>
  </button>

  <!-- ===== Scroll Scene ===== -->
  <section class="scene" id="scene">
    <div class="sticky" id="sticky">
      <!-- Hero -->
      <section id="hero" class="hero">
        <div class="hero-shell hero-fade">
          <div class="hero-inner">
            <img class="hero-banner hero-banner-top" src="./assets/top_banner.png?v=20250920" alt="상단 배너" decoding="async" />
            <img id="hero-img" class="hero-img" src="./assets/main-hero.png?v=20250920" alt="대표 이미지" decoding="async" fetchpriority="high" />
            <div class="hero-bottom">
              <div class="hero-location-shell">
                <img id="hero-location" class="hero-location" src="./assets/location.png?v=20250920" alt="위치 안내 구름" decoding="async"
                  role="button" tabindex="0" aria-haspopup="dialog" aria-controls="locationPopup" />
              </div>
              <div class="hero-play-shell">
                <img id="hero-play" class="hero-play"
                     src="./assets/play_game.png?v=20250920"
                     alt="게임 시작"
                     role="link" tabindex="0"
                     data-href="./games/game2" />
              </div>
              <img class="hero-banner hero-banner-bottom" src="./assets/bottom_banner.png?v=20250920" alt="하단 배너" decoding="async" />
            </div>
          </div>
        </div>

        <!-- 인디케이터: hero의 직속 자식 -->
        <div class="scroll-indicator" id="scrollIndicator">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 16l-6-6h12z"/></svg>
          <span>SCROLL</span>
        </div>
      </section>

      <!-- 긴 info 이미지 -->
      <div class="info-rail">
        <img class="info-img" id="infoImg" src="./assets/info.png?v=20250920" alt="판매 아이템 목록" loading="lazy" decoding="async" />
      </div>
    </div>
  </section>

  <!-- 위치 팝업 -->
  <div id="locationPopup" class="popup" hidden aria-hidden="true" tabindex="-1" role="dialog" aria-modal="true">
    <div class="popup-backdrop" data-popup-close></div>
    <div class="popup-card">
      <button type="button" class="popup-close" aria-label="닫기" data-popup-close>&times;</button>
      <img src="./assets/booth_position.png?v=20250920" alt="부스 위치" class="popup-img" decoding="async" />
    </div>
  </div>

  <!-- 기여자 팝업 (모바일용) -->
  <div id="contributorsPopup" class="popup" hidden aria-hidden="true" tabindex="-1" role="dialog" aria-modal="true" aria-labelledby="contributorsTitle">
    <div class="popup-backdrop" data-popup-close></div>
    <div class="popup-card contributors-popup-card">
      <button type="button" class="popup-close" aria-label="닫기" data-popup-close>&times;</button>
      <h3 id="contributorsTitle" class="contributors-popup-title">프로젝트 기여자</h3>
      <div id="contributorsPopupList" class="contributors-list" role="list"></div>
    </div>
  </div>

  <!-- 우측 하단 비공식 안내 배지 -->
  <div class="unofficial-badge" role="note" aria-label="비공식 팬 사이트 안내">
    <span>비공식 팬 사이트</span>
    <small>Not affiliated with NEXON</small>
  </div>

  <script>
    // 로딩 후 초기 등장 애니 트리거
    (function(){
      const imgs = Array.from(document.querySelectorAll('.hero-banner, .hero-img, .hero-location, .hero-play'));
      let ready = 0;
      const fire = ()=>{ if(++ready >= imgs.length) document.body.classList.add('ready'); };
      imgs.forEach(img=>{ img.complete ? fire() : img.addEventListener('load', fire, { once:true }); });
      setTimeout(()=>document.body.classList.add('ready'), 1200);
    })();

    // sticky 씬: 이미지 실제 렌더 높이에 맞춰 높이/이동량 계산 + 진행도→투명도/이동 반영
    (function(){
      const clamp = (n,min,max)=>Math.min(Math.max(n,min),max);
      const scene = document.getElementById('scene');
      const infoImg = document.getElementById('infoImg');
      const heroShell = document.querySelector('.hero-shell');
      const contributors = document.getElementById('contributorsList');
      const contributorsFab = document.getElementById('contributorsFab');

      let vh=0, imgH=0, total=0, startY=0, endY=0;

      function measure(){
        vh = window.innerHeight || document.documentElement.clientHeight;
        const renderedW = Math.min(1100, window.innerWidth * 0.95);
        if (infoImg.complete && infoImg.naturalWidth) {
          imgH = infoImg.naturalHeight * (renderedW / infoImg.naturalWidth);
        } else {
          imgH = 8237 * (renderedW / 1500); // fallback ratio
        }
        const sceneH = vh + imgH + Math.max(0.01*vh, 1);
        scene.style.height = `${sceneH}px`;
        total = sceneH - vh;
        startY = vh;
        endY   = -(imgH - vh);
      }

      let ticking = false;
      function apply(){
        const rect = scene.getBoundingClientRect();
        const scrolled = 0 - rect.top;
        const p = clamp(scrolled / total, 0, 1);

        const T = 0.13;
        const heroOpacity = 1 - Math.min(p / T, 1);

        document.documentElement.style.setProperty('--p', p.toFixed(4));
        document.documentElement.style.setProperty('--hero-o', heroOpacity.toFixed(4));

        const y = startY + (endY - startY) * p;
        infoImg.style.setProperty('--info-y', `${y.toFixed(2)}px`);

        // === 클릭/포커스 차단 임계값 ===
        const disable = heroOpacity < 0.05;

        // 히어로 버튼들
        heroShell.style.pointerEvents = disable ? 'none' : 'auto';
        const leftBtn  = document.getElementById('hero-location');
        const rightBtn = document.getElementById('hero-play');
        [leftBtn, rightBtn].forEach(el=>{
          if(!el) return;
          el.style.pointerEvents = disable ? 'none' : 'auto';
          el.tabIndex = disable ? -1 : 0;
          if (disable) el.setAttribute('aria-disabled','true'); else el.removeAttribute('aria-disabled');
        });

        // 데스크톱 기여자 스택
        if (contributors){
          contributors.style.pointerEvents = disable ? 'none' : 'auto';
          contributors.querySelectorAll('a').forEach(a=>{
            a.style.pointerEvents = disable ? 'none' : 'auto';
            a.tabIndex = disable ? -1 : 0;
            if (disable) { a.setAttribute('aria-hidden','true'); a.setAttribute('aria-disabled','true'); }
            else { a.removeAttribute('aria-hidden'); a.removeAttribute('aria-disabled'); }
          });
        }

        // 모바일 FAB
        if (contributorsFab){
          contributorsFab.style.pointerEvents = disable ? 'none' : 'auto';
          contributorsFab.tabIndex = disable ? -1 : 0;
          if (disable) contributorsFab.setAttribute('aria-disabled','true'); else contributorsFab.removeAttribute('aria-disabled');
        }

        ticking = false;
      }

      function onScroll(){ if (!ticking){ ticking = true; requestAnimationFrame(apply); } }
      function onResize(){ measure(); apply(); }

      if (!infoImg.complete) infoImg.addEventListener('load', onResize, { once:true });

      measure(); apply();
      window.addEventListener('scroll', onScroll, { passive:true });
      window.addEventListener('resize', onResize);
      window.addEventListener('orientationchange', onResize);
    })();

    // 위치 팝업
    (function(){
      const locationImg = document.getElementById('hero-location');
      const popup = document.getElementById('locationPopup');
      if(!locationImg || !popup) return;

      const closeTargets = popup.querySelectorAll('[data-popup-close]');
      let prevOverflow = '';

      const openPopup = ()=>{
        if(!popup.hidden) return;
        prevOverflow = document.documentElement.style.overflow;
        document.documentElement.style.overflow = 'hidden';
        popup.hidden = false;
        popup.setAttribute('aria-hidden', 'false');
        popup.focus?.();
      };
      const closePopup = ()=>{
        if(popup.hidden) return;
        popup.hidden = true;
        popup.setAttribute('aria-hidden', 'true');
        document.documentElement.style.overflow = prevOverflow;
        locationImg.focus();
      };
      const triggerShake = ()=>{
        locationImg.classList.remove('is-shaking');
        void locationImg.offsetWidth;
        locationImg.classList.add('is-shaking');
      };

      locationImg.addEventListener('click', ()=>{ triggerShake(); openPopup(); });
      locationImg.addEventListener('keydown', (event)=>{
        if(event.key === 'Enter' || event.key === ' '){
          event.preventDefault(); triggerShake(); openPopup();
        }
      });
      locationImg.addEventListener('animationend', (event)=>{
        if(event.animationName === 'cloudShake'){ locationImg.classList.remove('is-shaking'); }
      });
      closeTargets.forEach(el=> el.addEventListener('click', closePopup));
      window.addEventListener('keydown', (event)=>{ if(event.key === 'Escape') closePopup(); });
    })();

    // 기여자 데이터 (단일 소스)
    const CONTRIBUTORS_DATA = (function(){
      const VQ='?v=20250920';
      return [
        { name: '불카유카', url: 'https://www.youtube.com/@yuuka0314', icon: 'youtube' },
        { name: '뚜니펭귄', url: 'https://x.com/ddunipeng', icon: 'x' },
        { name: 'jwsts108', url: 'https://www.pixiv.net/users/100904459', iconPath: 'assets/logo/logo-pixiv.png'+VQ },
        { name: '푸른새싹', url: 'https://artmug.kr/index.php?channel=view&uid=33982', iconPath: 'assets/logo/logo-artmug.png'+VQ },
        { name: 'goms', url: 'https://github.com/goms7', icon: 'github' },
        { name: 'devbyhwang', url: 'https://github.com/devbyhwang', icon: 'github' },
      ];
    })();

    // 아이콘 빌더 (공용)
    function buildIconNode(c, size=18){
      if (c.iconPath){
        const img = document.createElement('img');
        img.src = c.iconPath; img.alt = ''; img.width = size; img.height = size;
        img.decoding = 'async'; img.loading = 'lazy';
        return img;
      }
      const id = ({youtube:'ic-youtube', x:'ic-x', github:'ic-github', link:'ic-link'}[c.icon] || 'ic-link');
      const svg = document.createElementNS('http://www.w3.org/2000/svg','svg');
      svg.setAttribute('aria-hidden','true'); svg.style.width = size+'px'; svg.style.height = size+'px';
      const use = document.createElementNS('http://www.w3.org/2000/svg','use');
      use.setAttributeNS('http://www.w3.org/1999/xlink','href','#'+id);
      svg.appendChild(use);
      svg.style.fill = (c.icon==='youtube') ? '#ff4d4f' : (c.icon==='x'||c.icon==='github') ? '#e5e7eb' : '#9ec5ff';
      return svg;
    }

    // 데스크톱 좌측 스택 렌더
    (function(){
      const root = document.getElementById('contributorsList');
      if(!root) return;
      const openAttrs = { target:'_blank', rel:'noopener noreferrer' };
      CONTRIBUTORS_DATA.forEach(c=>{
        const a = document.createElement('a');
        a.href = c.url; a.target = openAttrs.target; a.rel = openAttrs.rel;
        a.setAttribute('aria-label', `${c.name}로 이동`);
        a.appendChild(buildIconNode(c, 18));
        const label = document.createElement('span'); label.textContent = c.name;
        a.appendChild(label);
        root.appendChild(a);
      });
    })();

    // 모바일 FAB → 팝업 열기
    (function(){
      const fab = document.getElementById('contributorsFab');
      const popup = document.getElementById('contributorsPopup');
      const listRoot = document.getElementById('contributorsPopupList');
      if(!fab || !popup || !listRoot) return;

      // 1) 리스트 렌더 (모바일용)
      const openAttrs = { target:'_blank', rel:'noopener noreferrer' };
      CONTRIBUTORS_DATA.forEach(c=>{
        const a = document.createElement('a');
        a.href = c.url; a.target = openAttrs.target; a.rel = openAttrs.rel;
        a.className = 'contributors-item'; a.role = 'listitem';
        a.appendChild(buildIconNode(c, 20));
        const span = document.createElement('span'); span.textContent = c.name;
        a.appendChild(span);
        listRoot.appendChild(a);
      });

      // 2) 팝업 핸들러
      let prevOverflow = '';
      const openPopup = ()=>{
        if(!popup.hidden) return;
        prevOverflow = document.documentElement.style.overflow;
        document.documentElement.style.overflow = 'hidden';
        popup.hidden = false;
        popup.setAttribute('aria-hidden','false');
        popup.focus?.();
      };
      const closePopup = ()=>{
        if(popup.hidden) return;
        popup.hidden = true;
        popup.setAttribute('aria-hidden','true');
        document.documentElement.style.overflow = prevOverflow;
        fab.focus();
      };
      fab.addEventListener('click', openPopup);
      fab.addEventListener('keydown', (e)=>{
        if(e.key==='Enter' || e.key===' '){ e.preventDefault(); openPopup(); }
      });
      popup.querySelectorAll('[data-popup-close], .popup-backdrop').forEach(el=>{
        el.addEventListener('click', closePopup);
      });
      window.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closePopup(); });
    })();
  </script>
</body>
</html>